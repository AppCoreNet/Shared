parameters:
  configuration: 'Debug'
  
steps:
- pwsh: ./publish.ps1 -Properties @{Configuration='${{ parameters.configuration }}'; OutputDir='$(Build.ArtifactStagingDirectory)'}
  displayName: Publish
- task: NuGetCommand@2
  condition: eq(variables['Build.Reason'], 'PullRequest')
  displayName: Push CI Packages
  inputs:
    command: push
    nuGetFeedType: external
    publishFeedCredentials: MyGet CI
    packagesToPush: $(Build.ArtifactStagingDirectory)/packages/**.*nupkg
- task: NuGetCommand@2
  condition: eq(variables['Build.SourceBranch'], 'refs/heads/dev')
  displayName: Push Packages
  inputs:
    command: push
    nuGetFeedType: external
    publishFeedCredentials: MyGet
    packagesToPush: $(Build.ArtifactStagingDirectory)/packages/**.*nupkg
